
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>UPGRADING from 15.12 to 16.12 &#8212; Python  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="upgrading-from-15-12-to-16-12">
<h1>UPGRADING from 15.12 to 16.12<a class="headerlink" href="#upgrading-from-15-12-to-16-12" title="Permalink to this headline">¶</a></h1>
<section id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p>An SQL migration script is provided in the <span class="xref myst">migrations/16.12</span> folder. It creates two new schemas, and several tables in the <code class="docutils literal notranslate"><span class="pre">extractorapp</span></code> schema.
It is a required addition before the <code class="docutils literal notranslate"><span class="pre">extractorapp</span></code> and <code class="docutils literal notranslate"><span class="pre">atlas</span></code> modules are started.</p>
<p>The LDAPadmin webapp should also create these new tables automatically during the first startup:</p>
<ul class="simple">
<li><p>ldapadmin.admin_attachments</p></li>
<li><p>ldapadmin.admin_emails</p></li>
<li><p>ldapadmin.admin_emails_attachments</p></li>
<li><p>ldapadmin.admin_log</p></li>
<li><p>ldapadmin.email_template</p></li>
</ul>
</section>
<section id="ldap">
<h2>LDAP<a class="headerlink" href="#ldap" title="Permalink to this headline">¶</a></h2>
<p>There are several important changes in the LDAP:</p>
<ul class="simple">
<li><p>What we used to call <code class="docutils literal notranslate"><span class="pre">groups</span></code> is now called <code class="docutils literal notranslate"><span class="pre">roles</span></code>. As a result, in the LDAP tree, eg <code class="docutils literal notranslate"><span class="pre">ou=groups,dc=georchestra,dc=org</span></code> should be renamed into <code class="docutils literal notranslate"><span class="pre">ou=roles,dc=georchestra,dc=org</span></code>.</p></li>
<li><p>A new <code class="docutils literal notranslate"><span class="pre">ou=orgs,dc=georchestra,dc=org</span></code> has been created to host the Organization objects. An org is made of an <code class="docutils literal notranslate"><span class="pre">organization</span></code> linked with a <code class="docutils literal notranslate"><span class="pre">groupOfMembers</span></code>-typed object.</p></li>
<li><p><strong>Roles are now expected to have parent roles</strong>, eg role <code class="docutils literal notranslate"><span class="pre">EL</span></code> is the parent of role <code class="docutils literal notranslate"><span class="pre">EL_DSI</span></code>, which is the parent of role <code class="docutils literal notranslate"><span class="pre">EL_DSI_SERVICE</span></code>. This allows for an easy browsing between roles in the new Console application, but there’s <a class="reference external" href="https://github.com/georchestra/georchestra/issues/1559">more to come</a>.</p></li>
<li><p>Several static roles have been renamed:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">SV_USER</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">USER</span></code> is the basic role <strong>expected for all geOrchestra users</strong>, including administrators.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SV_ADMIN</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">GN_ADMIN</span></code> is for the GeoNetwork administrators.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SV_REVIEWER</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">GN_REVIEWER</span></code> is for the GeoNetwork metadata reviewers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SV_EDITOR</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">GN_EDITOR</span></code> is for the GeoNetwork metadata editors.</p></li>
</ul>
</li>
<li><p>All users (<code class="docutils literal notranslate"><span class="pre">inetOrgPerson</span></code>) should also have the <code class="docutils literal notranslate"><span class="pre">shadowAccount</span></code> objectClass. This allows to set an account expiration date.</p></li>
<li><p>We now require the <code class="docutils literal notranslate"><span class="pre">memberof</span></code> overlay to be configured with <code class="docutils literal notranslate"><span class="pre">olcMemberOfRefInt:</span> <span class="pre">TRUE</span></code> (it was previously set to <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>). It enables integrity check between the <code class="docutils literal notranslate"><span class="pre">member</span></code> and <code class="docutils literal notranslate"><span class="pre">memberOf</span></code> values. Without this parameter, the <code class="docutils literal notranslate"><span class="pre">member</span></code> and <code class="docutils literal notranslate"><span class="pre">memberOf</span></code> can get out of sync. For more information, see <a class="reference external" href="https://github.com/georchestra/georchestra/commit/534606e97186988ba2a672b729b2031e55256cfc">this commit</a>.</p></li>
</ul>
<p>Since we introduced orgs, the <code class="docutils literal notranslate"><span class="pre">o</span></code> field which can be found in every <code class="docutils literal notranslate"><span class="pre">inetOrgPerson</span></code> instance is not used anymore. Instead, the org title should be used.
In the <span class="xref myst">migrations/16.12</span> folder, we added a python script which helps creating the new Organizations in your LDAP, based on your user’s current organization titles (from the <code class="docutils literal notranslate"><span class="pre">o</span></code> attribute).</p>
<p>The recommended way to upgrade your LDAP database is the following:</p>
<ul class="simple">
<li><p>dump all LDAP objects in a LDIF file</p></li>
<li><p>edit the LDIF file</p></li>
<li><p>reimport it</p></li>
</ul>
<p>Here’s the <a class="reference external" href="https://gist.github.com/fvanderbiest/7c8ae5656e29325cc0372eb2dc0519d8">full LDAP diff</a> for the curious ones.</p>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this headline">¶</a></h2>
<p><strong>The geOrchestra datadir is now mandatory</strong>. It is indeed possible to fully configure a standard geOrchestra instance without having to build it.<br />
Please read the notes from the <a class="reference external" href="https://github.com/georchestra/datadir/blob/master/README.md">georchestra/datadir</a> repository before you upgrade. To proceed, we recommend (first a backup, then …) the use of the <code class="docutils literal notranslate"><span class="pre">meld</span></code> tool to compare your existing datadir and a fresh copy of the datadir (on branch 16.12).</p>
<p>For the mapfishapp viewer, we restored the ability to choose which context is shown by default through the <code class="docutils literal notranslate"><span class="pre">GEOR.custom.DEFAULT_WMC</span></code> config option.
Read <a class="reference external" href="https://github.com/georchestra/georchestra/pull/1354">#1534</a> for more.</p>
<p>GeoServer datadir:</p>
<ul class="simple">
<li><p>the logging configuration has been improved</p></li>
<li><p>the rest configuration should be modified to take into account roles renaming</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">role</span></code> and <code class="docutils literal notranslate"><span class="pre">usergroup</span></code> services have been plugged onto the LDAP, which provides <strong>automatic role creation in GeoServer</strong>.
Please refer to this <a class="reference external" href="https://gist.github.com/fvanderbiest/2ae1bac7e4dd3023e1060b8deab6683b">geoserver datadir full diff</a> for upgrade guidance.</p></li>
</ul>
<p>Rewrite rules which add an extra trailing slash on webapps are no longer needed on the frontend webserver, since it is now managed security-proxy side.
Please refer to <a class="reference external" href="https://github.com/georchestra/georchestra/pull/1502/files">#1502</a> for more information.</p>
<p>If you had JSP files customised in your own profile, you should synchronise them with upstream changes. Namely, with <a class="reference external" href="https://github.com/georchestra/georchestra/issues/1480">#1480</a> we removed the need for a <code class="docutils literal notranslate"><span class="pre">header.js</span></code> file, and the header iframe’s calling <code class="docutils literal notranslate"><span class="pre">onload=&quot;_headerOnLoad(this)&quot;</span></code>. This also improves the header response times.</p>
</section>
<section id="others">
<h2>Others<a class="headerlink" href="#others" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ROLE_ANONYMOUS</span></code> does not exist anymore.<br />
Applications should not use it. Instead, they should rely on the <code class="docutils literal notranslate"><span class="pre">sec-username</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">sec-roles</span></code> values.</p>
<p>The security-proxy-generated <code class="docutils literal notranslate"><span class="pre">sec-org</span></code> header now maps to the user’s Org <code class="docutils literal notranslate"><span class="pre">cn</span></code>, rather than the inetOrgPerson’s <code class="docutils literal notranslate"><span class="pre">o</span></code> field. In addition, the <code class="docutils literal notranslate"><span class="pre">sec-orgname</span></code> header is now added to proxied requests, which maps to the user’s organism title (ie the <code class="docutils literal notranslate"><span class="pre">o</span></code> field from the Org’s groupOfMembers instance). This means that applications which were relying on the <code class="docutils literal notranslate"><span class="pre">sec-org</span></code> header should now use <code class="docutils literal notranslate"><span class="pre">sec-orgname</span></code> instead.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Python</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/16.12/README.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>