
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Setting up Apache &#8212; Python  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="setting-up-apache">
<h1>Setting up Apache<a class="headerlink" href="#setting-up-apache" title="Permalink to this headline">¶</a></h1>
<p>We assume here that SSL is used for the whole SDI.<br />
Having a mixed SSL/non-SSL setup should work, but will require several changes in your configuration.</p>
<section id="modules-setup">
<h2>Modules setup<a class="headerlink" href="#modules-setup" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">a2enmod</span> <span class="n">proxy</span> <span class="n">proxy_http</span> <span class="n">ssl</span> <span class="n">rewrite</span> <span class="n">headers</span> <span class="n">deflate</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">apache2</span>
</pre></div>
</div>
</section>
<section id="directory-structure">
<h2>Directory structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">htdocs</span>
<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">conf</span>
<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">logs</span>
<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">ssl</span>
</pre></div>
</div>
<p>Debian apache user being www-data, we have to grant write on logs to www-data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chgrp</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="n">g</span><span class="o">+</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span>
</pre></div>
</div>
<p>We publish sample files for your htdocs folder in the <a class="reference external" href="https://github.com/georchestra/htdocs">georchestra/htdocs</a> repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span>
<span class="n">sudo</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">htdocs</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>It is recommended to edit them to match your setup.</p>
</section>
<section id="virtualhosts">
<h2>VirtualHosts<a class="headerlink" href="#virtualhosts" title="Permalink to this headline">¶</a></h2>
<p>Let’s first deactivate the default virtualhosts, and create ours:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">a2dissite</span> <span class="n">default</span> <span class="mi">000</span><span class="o">-</span><span class="n">default</span> <span class="n">default</span><span class="o">-</span><span class="n">ssl</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">/etc/apache2/sites-available/georchestra.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VirtualHost</span> <span class="o">*</span><span class="p">:</span><span class="mi">80</span><span class="o">&gt;</span>
    <span class="n">ServerName</span> <span class="n">georchestra</span><span class="o">.</span><span class="n">mydomain</span><span class="o">.</span><span class="n">org</span>
    <span class="n">DocumentRoot</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">htdocs</span>
    <span class="n">LogLevel</span> <span class="n">warn</span>
    <span class="n">ErrorLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">error</span><span class="o">.</span><span class="n">log</span>
    <span class="n">CustomLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">access</span><span class="o">.</span><span class="n">log</span> <span class="s2">&quot;combined&quot;</span>
    <span class="n">Include</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">conf</span><span class="o">/*.</span><span class="n">conf</span>
    <span class="n">ServerSignature</span> <span class="n">Off</span>
    <span class="n">RewriteCond</span> <span class="o">%</span><span class="p">{</span><span class="n">HTTPS</span><span class="p">}</span> <span class="n">off</span>
    <span class="n">RewriteRule</span> <span class="p">(</span><span class="o">.*</span><span class="p">)</span> <span class="n">https</span><span class="p">:</span><span class="o">//%</span><span class="p">{</span><span class="n">HTTP_HOST</span><span class="p">}</span><span class="o">%</span><span class="p">{</span><span class="n">REQUEST_URI</span><span class="p">}</span>
<span class="o">&lt;/</span><span class="n">VirtualHost</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">VirtualHost</span> <span class="o">*</span><span class="p">:</span><span class="mi">443</span><span class="o">&gt;</span>
    <span class="n">ServerName</span> <span class="n">georchestra</span><span class="o">.</span><span class="n">mydomain</span><span class="o">.</span><span class="n">org</span>
    <span class="n">DocumentRoot</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">htdocs</span>
    <span class="n">LogLevel</span> <span class="n">warn</span>
    <span class="n">ErrorLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">error</span><span class="o">.</span><span class="n">log</span>
    <span class="n">CustomLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">access</span><span class="o">.</span><span class="n">log</span> <span class="s2">&quot;combined&quot;</span>
    <span class="n">Include</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">conf</span><span class="o">/*.</span><span class="n">conf</span>
    <span class="n">SSLEngine</span> <span class="n">On</span>
    <span class="n">SSLCertificateFile</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">georchestra</span><span class="o">.</span><span class="n">crt</span>
    <span class="n">SSLCertificateKeyFile</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">georchestra</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">georchestra</span><span class="o">-</span><span class="n">unprotected</span><span class="o">.</span><span class="n">key</span>
    <span class="n">SSLCACertificateFile</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span><span class="n">ca</span><span class="o">-</span><span class="n">certificates</span><span class="o">.</span><span class="n">crt</span>
    <span class="c1"># alternate setup with letsencrypt:</span>
    <span class="c1">#SSLCertificateFile /etc/letsencrypt/live/mysdi.org/cert.pem</span>
    <span class="c1">#SSLCertificateKeyFile /etc/letsencrypt/live/mysdi.org/privkey.pem</span>
    <span class="c1">#SSLCertificateChainFile /etc/letsencrypt/live/mysdi.org/fullchain.pem</span>
    <span class="n">ServerSignature</span> <span class="n">Off</span>
<span class="o">&lt;/</span><span class="n">VirtualHost</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Update your hosts files (in /etc/hosts):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">127.0.0.1</span>       <span class="n">georchestra</span><span class="o">.</span><span class="n">mydomain</span><span class="o">.</span><span class="n">org</span>
</pre></div>
</div>
<p>Once this is done, enable the georchestra site with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">a2ensite</span> <span class="n">georchestra</span>
</pre></div>
</div>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">/var/www/georchestra/conf/</span></code>, we will create several files, which will be loaded by both virtualhosts.
In these files, we will make the assumption that the tomcat hosting the security proxy listens on port 8180. You may need to adapt this to your setup.</p>
<p>Three of these files are required:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">global.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;IfModule !mod_proxy.c&gt;
    LoadModule proxy_module /usr/lib/apache2/modules/mod_proxy.so
&lt;/IfModule&gt;
&lt;IfModule !mod_proxy_http.c&gt;
    LoadModule proxy_http_module /usr/lib/apache2/modules/mod_proxy_http.so
&lt;/IfModule&gt;

RewriteEngine On

AddOutputFilterByType DEFLATE text/html text/plain text/xml application/xml text/css text/javascript application/javascript

ProxyRequests Off
ProxyTimeout 86400

AddType application/vnd.ogc.context+xml .wmc

ErrorDocument 502 /errors/50x.html
ErrorDocument 503 /errors/50x.html

# redirects onto the viewer by default
RewriteRule ^/$ https://%{SERVER_NAME}/mapfishapp/ [R=301,L]

</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proxy.conf</span></code>: replace the <code class="docutils literal notranslate"><span class="pre">http://my\.sdi\.org</span></code> string with your server address in the following:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ProxyPass</span> <span class="o">/</span><span class="n">casfailed</span><span class="o">.</span><span class="n">jsp</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">casfailed</span><span class="o">.</span><span class="n">jsp</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">casfailed</span><span class="o">.</span><span class="n">jsp</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">casfailed</span><span class="o">.</span><span class="n">jsp</span>

<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">login</span><span class="o">/</span><span class="n">cas</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">login</span><span class="o">/</span><span class="n">cas</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">login</span><span class="o">/</span><span class="n">cas</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">login</span><span class="o">/</span><span class="n">cas</span>

<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">logout</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">logout</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">logout</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">logout</span>

<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">gateway</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">gateway</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">gateway</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">gateway</span>

<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">testPage</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">testPage</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">testPage</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">testPage</span>

<span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">_static</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">_static</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">_static</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">_static</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">_static</span><span class="o">/</span>

<span class="n">SetEnvIf</span> <span class="n">Referer</span> <span class="s2">&quot;^https://georchestra\.mydomain\.org/&quot;</span> <span class="n">mysdi</span>
<span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">proxy</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="n">env</span> <span class="n">mysdi</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">proxy</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">proxy</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">proxy</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">proxy</span><span class="o">/</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cas.conf</span></code>:</p></li>
</ul>
<p>The cas module should be accessed only through https.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
&lt;Proxy http://localhost:8180/cas/*&gt;
    Require all granted
&lt;/Proxy&gt;
ProxyPass /cas/ http://localhost:8180/cas/
ProxyPassReverse /cas/ http://localhost:8180/cas/

RewriteCond %{HTTPS} off
RewriteCond %{REQUEST_URI} ^/cas/?.*$
RewriteRule ^/(.*)$ https://%{SERVER_NAME}/$1 [R=301,L]
</pre></div>
</div>
<p>For the other ones, pick only those you need, depending on the modules you plan to install:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">analytics.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">analytics</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">analytics</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">analytics</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">analytics</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">analytics</span><span class="o">/</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">extractorapp.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">extractorapp</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">extractorapp</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">extractorapp</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">extractorapp</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">extractorapp</span><span class="o">/</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">geonetwork.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geonetwork</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">geonetwork</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geonetwork</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">geonetwork</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geonetwork</span><span class="o">/</span>
</pre></div>
</div>
<p>Optionally, to preserve permalinks generated with a previous GeoNetwork 2.x instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Location</span> <span class="s2">&quot;/geonetwork&quot;</span><span class="o">&gt;</span>
	<span class="n">RewriteEngine</span> <span class="n">on</span>
	<span class="n">RewriteCond</span> <span class="s2">&quot;%</span><span class="si">{REQUEST_URI}</span><span class="s2">&quot;</span> <span class="s2">&quot;/geonetwork/apps/georchestra/&quot;</span>
	<span class="n">RewriteCond</span> <span class="s2">&quot;%</span><span class="si">{QUERY_STRING}</span><span class="s2">&quot;</span> <span class="s2">&quot;(.*(?:^|&amp;))uuid=([^&amp;]*)&amp;?(.*)&amp;?$&quot;</span>
	<span class="n">RewriteRule</span> <span class="s2">&quot;(.*)&quot;</span> <span class="s2">&quot;/geonetwork/srv/eng/catalog.search#/metadata/%2&quot;</span> <span class="p">[</span><span class="n">R</span><span class="o">=</span><span class="mi">302</span><span class="p">,</span><span class="n">NE</span><span class="p">,</span><span class="n">QSD</span><span class="p">,</span><span class="n">L</span><span class="p">]</span>
<span class="o">&lt;/</span><span class="n">Location</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">geoserver.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">Location</span> <span class="o">/</span><span class="n">geoserver</span><span class="o">&gt;</span>
  <span class="n">Header</span> <span class="nb">set</span> <span class="n">Access</span><span class="o">-</span><span class="n">Control</span><span class="o">-</span><span class="n">Allow</span><span class="o">-</span><span class="n">Origin</span> <span class="s2">&quot;*&quot;</span>
  <span class="n">Header</span> <span class="nb">set</span> <span class="n">Access</span><span class="o">-</span><span class="n">Control</span><span class="o">-</span><span class="n">Allow</span><span class="o">-</span><span class="n">Headers</span> <span class="s2">&quot;Origin, X-Requested-With, Content-Type, Accept&quot;</span>
<span class="o">&lt;/</span><span class="n">Location</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">geoserver</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">geoserver</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">geowebcache.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geowebcache</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">geowebcache</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geowebcache</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">geowebcache</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">geowebcache</span><span class="o">/</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">header.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">header</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">header</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">header</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">header</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">header</span><span class="o">/</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">console.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">console</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">console</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">console</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">console</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">console</span><span class="o">/</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mapfishapp.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">mapfishapp</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">mapfishapp</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">mapfishapp</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">mapfishapp</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">mapfishapp</span><span class="o">/</span>
</pre></div>
</div>
<p>Note that mapfishapp provides the option to display local files on the map. To do this, the file is uploaded to the mapfishapp backend. The maximum size of these file can be defined in the <a class="reference external" href="https://github.com/georchestra/datadir/blob/18.12/mapfishapp/mapfishapp.properties#L23">datadir</a>, but in certain cases, the Apache2 proxy could be more restrictive if the <a class="reference external" href="https://httpd.apache.org/docs/current/mod/mod_proxy.html#request-bodies"><code class="docutils literal notranslate"><span class="pre">LimitRequestBody</span></code></a> had been set to a lower limit. For a normal usage, you don’t need to set the <code class="docutils literal notranslate"><span class="pre">LimitRequestBody</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">atlas.conf</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">atlas</span><span class="o">/*&gt;</span>
    <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
<span class="n">ProxyPass</span> <span class="o">/</span><span class="n">atlas</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">atlas</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span><span class="n">atlas</span><span class="o">/</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8180</span><span class="o">/</span><span class="n">atlas</span><span class="o">/</span>
</pre></div>
</div>
</section>
<section id="ssl-certificate">
<h2>SSL certificate<a class="headerlink" href="#ssl-certificate" title="Permalink to this headline">¶</a></h2>
<p>A SSL certificate is now absolutely required, as the security-proxy is configured to provide “secured” cookie (i.e. which are discarded by the browser if not transmitted over a https connection).</p>
<p>We recommend using a certificate issued by <a class="reference external" href="https://letsencrypt.org/">Let’s Encrypt</a>, but one may also use a <a class="reference internal" href="../tutorials/self-signed-certificate.html"><span class="doc std std-doc">self-signed certificate</span></a>.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Python</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/setup/apache.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>